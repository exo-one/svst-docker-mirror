# WARNING - Do not edit this file directly - use regen-docker-test.sh

services:
  bitcoind:
    build: {context: ./docker-bitcoind/}
    entrypoint: sh -c 'btc_init && bitcoind -regtest'
    env_file: env_vars.env
    ports: ['8332:8332', '8333:8333', '18333:18333']
  header-download:
    build: {context: ./dockerfiles/header-download/, dockerfile: Dockerfile, env_file: env_vars.env}
    depends_on: [postgres]
  ipfs:
    depends_on: [bitcoind]
    image: jbenet/go-ipfs
    ports: ['127.0.0.1:5001:5001', '4001:4001']
  pallet-download:
    build: {context: ./dockerfiles/pallet-download/, dockerfile: Dockerfile}
    depends_on: [bitcoind]
  pallet-verifier:
    build: {context: ./dockerfiles/pallet-verifier/, dockerfile: Dockerfile}
    depends_on: [postgres]
    entrypoint: verifier
  postgres:
    depends_on: [ipfs]
    environment: [PGDATA=/postgres-data]
    expose: ['5678']
    image: postgres:9.6
  producer:
    build: {context: ./dockerfiles/producer/, dockerfile: Dockerfile}
    depends_on: [postgres]
    entrypoint: pallet-gen 10
  scraper:
    build: {context: ./dockerfiles/scraper/, dockerfile: Dockerfile}
    depends_on: [postgres]
    entrypoint: scraper
  state-maker:
    build: {context: ./dockerfiles/state-maker/, dockerfile: Dockerfile}
    depends_on: [postgres]
  sut:
    build: {context: ., dockerfile: Dockerfile.test}
  vote-explorer:
    build: {context: ./dockerfiles/vote-explorer/, dockerfile: Dockerfile}
    depends_on: [state-maker]
    ports: ['8080:80']
version: '2.1'
